"use strict";function ShippingAddressController(n,t,i,r,u){function h(){var n=f.configData.isVisible;f.requiredFields={firstName:n,lastName:n,email:n,company:n&&f.shippingData.settings.companyEnabled!==!1&&f.shippingData.settings.companyRequired,country:n&&f.shippingData.settings.countryEnabled!==!1,stateProvince:n&&f.shippingData.settings.stateProvinceEnabled,city:n&&f.shippingData.settings.cityEnabled!==!1&&f.shippingData.settings.cityRequired,address1:n&&f.shippingData.settings.streetAddressEnabled!==!1&&f.shippingData.settings.streetAddressRequired,address2:n&&f.shippingData.settings.streetAddress2Enabled!==!1&&f.shippingData.settings.streetAddress2Required,zipPostalCode:n&&f.shippingData.settings.zipPostalCodeEnabled!==!1&&f.shippingData.settings.zipPostalCodeRequired,phoneNumber:n&&f.shippingData.settings.phoneEnabled!==!1&&f.shippingData.settings.phoneRequired,faxNumber:n&&f.shippingData.settings.faxEnabled!==!1&&f.shippingData.settings.faxRequired}}var f=this;f.shippingData={};f.configData={};f.configData.isVisible=!0;var o=!1,e=!1,s=!1;f.addressAttributeChanged=function(n,t){u.syncAttributeWithModel(t,n)};r.load(!0); f.buscaCEP = function () { var cep = $('#shippingZipPostalCode').val().replace(/\D/g, ""); $.ajax({ cache: false, type: "GET", url: "/Plugins/ShippingCorreios/GetAddresByCEP", data: { "cep": cep }, success: function (data) {  $('#shippingCity').val(data.cidade); $('#shippingCity').trigger('input'); $('#shippingAddress1').val(data.end); $('#shippingAddress1').trigger('input');  $('#shippingAddress2').val(data.bairro); $('#shippingAddress2').trigger('input');}});; }; n.$on("togglePanel",function(n,t){angular.isDefined(t.shipToSameAddress)&&(o=t.shipToSameAddress);angular.isDefined(t.pickUpInStore)&&(e=t.pickUpInStore,e===!0&&(f.shippingData.selectedShippingAddress={country:{},stateProvince:{}},r.set(f.shippingData.selectedShippingAddress)));angular.isDefined(t.hasProductsRequiringShipping)&&(s=t.hasProductsRequiringShipping);f.configData.isVisible=!(o||e)&&s;angular.isDefined(f.shippingData.settings)&&h();var i=r.get();angular.copy(i,f.shippingData)});n.$on("updateShippingAddress",function(n,t){t&&t.address&&(angular.copy(t.address,f.shippingData.selectedShippingAddress),u.prepareDefaultSelectedValues(f.shippingData.selectedShippingAddress,f.modelsData))});n.$on("refresh",function(){var n=r.get();angular.copy(n,f.shippingData);!angular.isDefined(f.requiredFields)&&angular.isDefined(f.shippingData.settings)&&h();f.shippingData.selectedShippingAddress&&f.shippingData.selectedShippingAddress.customAddressAttributes&&f.shippingData.selectedShippingAddress.customAddressAttributes.length>0&&!angular.isDefined(f.modelsData)&&(f.modelsData={},u.prepareDefaultSelectedValues(f.shippingData.selectedShippingAddress,f.modelsData));u.hideOverlay(".shipping-address-loader")});n.$on("configurationReady",function(n,i){t.$evalAsync(function(){f.config=i;f.config.defaultShippingCountryId&&f.shippingData.selectedShippingAddress&&f.shippingData.selectedShippingAddress.country&&(!f.shippingData.selectedShippingAddress.country.value||f.shippingData.selectedShippingAddress.country.value=="0")&&(f.shippingData.selectedShippingAddress.country.value=f.config.defaultShippingCountryId.toString())})});n.$on("setShippingAddressOverlay",function(){u.showOverlay(".shipping-address-loader")});t.$watch("vm.shippingData.selectedShippingAddress",function(n,t){n&&t&&r.set(n)},!0);n.$on("prepareDefaultSelectedValuesForCustomAddressAttributes",function(n,i){(i.panel=="shipping"||i.panel=="billing"&&i.shipToSameAddress)&&setTimeout(function(){t.$apply(function(){u.prepareDefaultSelectedValues(f.shippingData.selectedShippingAddress,f.modelsData)})})});$(".shipping-address .choose-address select").change(function(){n.$broadcast("addressChanged",{panel:"shipping",shipToSameAddress:f.shipToSameAddress})})}angular.module("realOnePageCheckout.shippingAddress").controller("ShippingAddressController",ShippingAddressController);ShippingAddressController.$inject=["$rootScope","$scope","$timeout","shippingAddressContext","objectUtility"];