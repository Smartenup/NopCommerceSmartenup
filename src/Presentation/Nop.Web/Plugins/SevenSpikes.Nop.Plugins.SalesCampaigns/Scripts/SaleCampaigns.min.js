/*
* Copyright 2015 Seven Spikes Ltd. All rights reserved. (http://www.nop-templates.com)
* http://www.nop-templates.com/t/licensinginfo
*/

$(document).ready(function () { !function (t, e, a) { function n() { var t = { day: sevenSpikes.getAttrValFromDom(p, "data-localization-day"), days: sevenSpikes.getAttrValFromDom(p, "data-localization-days"), hour: sevenSpikes.getAttrValFromDom(p, "data-localization-hour"), hours: sevenSpikes.getAttrValFromDom(p, "data-localization-hours"), minute: sevenSpikes.getAttrValFromDom(p, "data-localization-minute"), minutes: sevenSpikes.getAttrValFromDom(p, "data-localization-minutes"), second: sevenSpikes.getAttrValFromDom(p, "data-localization-second"), seconds: sevenSpikes.getAttrValFromDom(p, "data-localization-seconds") }; return t } function o() { var t = []; return e(v).each(function () { var a = e(this).attr("data-productid"); if (a && a > 0) { var n = { productId: a, productElement: e(this) }; t.push(n) } }), t } function r(t, a) { var n = sevenSpikes.getAttrValFromDom(p, "data-productbox-picture-container-selector"); if (n) { var o = a.productElement.find(n); if (!o.length && a.productElement.is(n) && (o = a.productElement), o && a.productId && a.productId > 0) { var r = a.productId, i = e(t).filter("div[data-productId='" + r + "']"); i && i.length > 0 && e(o).prepend(i) } } } function i(t, e) { if (e && e.length > 0) { for (var a = 0; a < e.length; a++) { var n = e[a]; r(t, n) } d() } } function s() { return sevenSpikes.getAttrValFromDom(p, "data-retrieve-sales-campaings-url") } function l(t, a, n, o) { var r = Math.floor(a / 60 / 60 / 24), i = a / 60 / 60; 10 !== n && (i %= 24), i = Math.floor(i); var s = Math.floor(a / 60 % 60), l = a % 60, c = ""; if (10 !== n) { var d = 1 !== r ? m.days : m.day; if (o) { var u = e(t).find(".days"); u.children(".sale-campaign-box").text(r), u.children(".sale-campaign-box-label").text(d) } else c += r + " " + d } if (15 !== n) { var p = 1 !== i ? m.hours : m.hour, v = 1 !== s ? m.minutes : m.minute, g = 1 !== l ? m.seconds : m.second; if (o) { var f = e(t).find(".hours"); f.children(".sale-campaign-box").text(i), f.children(".sale-campaign-box-label").text(p); var h = e(t).find(".minutes"); h.children(".sale-campaign-box").text(s), h.children(".sale-campaign-box-label").text(v); var x = e(t).find(".seconds"); x.children(".sale-campaign-box").text(l), x.children(".sale-campaign-box-label").text(g) } else 10 !== n && (c += ", "), c += i + " " + p + ", ", c += s + " " + v + ", ", c += l + " " + g } o || e(t).html(c) } function c(t, a, n) { return l(t, a, n, t.hasClass("category-countdown")), a -= 1, t.data("time", a), 0 > a && (t.hasClass("category-countdown") ? e(t).remove() : e(t).parent().remove(), clearInterval(u)), a } function d() { e(".countdownTimer").each(function () { var t = e(this), a = t.data("time"), n = parseInt(a), o = t.data("clocktype"), r = parseInt(o); n = c(t, n, r), u = setInterval(function () { n = c(t, n, r) }, 1e3) }) } var u, p = "#sales-campaign-info", m = n(), v = sevenSpikes.getAttrValFromDom(p, "data-productbox-selector"); v && (t.getCountdownTimers = function () { var t = o(); if (t && 0 !== t.length) { for (var a = [], n = 0; n < t.length; n++) { var r = t[n]; r.hasOwnProperty("productId") && a.push(r.productId) } var l = { productIds: a }, c = s(); e.ajax({ cache: !1, type: "POST", data: e.toJSON(l), contentType: "application/json; charset=utf-8", url: c, success: function (a) { a && (i(a, t), e.event.trigger({ type: "nopSalesCampaignsLoadingCompleteEvent" })) }, error: function () { } }) } }, t.getCountdownTimers(), d()) }(window.nopSalesCampaigns = window.nopSalesCampaigns || {}, jQuery), $(document).on("nopAjaxFiltersFiltrationCompleteEvent newProductsAddedToPageEvent", nopSalesCampaigns.getCountdownTimers) });
